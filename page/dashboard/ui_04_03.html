

<!DOCTYPE html>
<html lang="ko">

<head>
	<title>대시보드 - Aegis</title>
	<meta charset="UTF-8" http-equiv="Content-Type">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=3.0">
	<meta name="mobile-web-app-capable" content="yes">
	<meta name="format-detection" content="telephone=no" />
	
	<!-- TODO: search engine info -->
	<meta name="robots" content="Aegis" />
	<meta name="keywords" content="Aegis" />
	<meta name="title" content="Aegis" />
	<meta name="description" content="Aegis" />
	
	<!-- TODO: social url link image -->
	<meta property="og:url" content="">
	<meta property="og:title" content="Aegis">
	<meta property="og:type" content="website">
	<meta property="og:image" content="">
	<meta property="og:description" content="Aegis 홈페이지입니다.">
	
	<!-- TODO: favicon -->
	<link rel="icon" href="./assets/images/favicon.png" type="image/png" />
	
	<!-- TODO: import -->
	<link rel="stylesheet" href="/assets/css/lib/bootstrap.min.css">
<link rel="stylesheet" href="/assets/css/lib/bootstrap-datetimepicker.min.css">
<link rel="stylesheet" href="/assets/css/lib/datatables.css?v=">
<link rel="stylesheet" href="/assets/css/lib/select.dataTables.css?v=">
<link rel="stylesheet" href="/assets/css/lib/jquery.mCustomScrollbar.css">
<link rel="stylesheet" href="/assets/css/lib/jquery.scrollbar.css">
<link rel="stylesheet" href="/assets/css/lib/jstree.css">
<link rel="stylesheet" href="/assets/css/reset.css?v=">
<link rel="stylesheet" href="/assets/css/style.css?v=">
<link rel="stylesheet" href="/assets/css/json-viewer.css">
<link rel="stylesheet" href="/assets/css/common.css?v=">


<script src="/assets/js/lib/jquery-1.12.4.min.js?v="></script>
<script src="/assets/js/lib/jquery-ui.js"></script>
<script src="/assets/js/lib/jquery.min.js?v="></script>
<script src="/assets/js/lib/bootstrap.min.js"></script>
<script src="/assets/js/lib/moment.js"></script>
<script src="/assets/js/lib/bootstrap-datetimepicker.js"></script>
<script src="/assets/js/lib/jquery-ui.js?v="></script>
<script src="/assets/js/lib/echarts.js?v="></script>
<script src="/assets/js/lib/jquery.nice-select.js?v="></script>
<script src="/assets/js/lib/select.dataTables.js?v="></script>
<script src="/assets/js/lib/datatables.js?v="></script>
<script src="/assets/js/lib/dataTables.colReorder.js?v="></script>
<script src="/assets/js/lib/dataTables.rowReorder.js?v="></script>
<script src="/assets/js/lib/dataTables.buttons.min.js?v="></script>
<script src="/assets/js/lib/sweetalert.js"></script>
<script src="/assets/js/lib/jquery.mCustomScrollbar.js"></script>
<script src="/assets/js/lib/jquery.scrollbar.js"></script>
<script src="/assets/js/lib/jstree-3.3.11.js"></script>
<script src="/assets/js/scripts.js?v="></script>

<script src="/js/common/define.js?v="></script>
<script src="/js/common/basic_common.js?v="></script>
<script src="/js/common/cf_common.js?v="></script>
<script src="/js/common/event_common.js?v="></script>
<script src="/js/common/json-viewer.js?v="></script>
<script src="/js/common/expansion_common.js?v="></script>

	
	<script src="./js/common/page_common.js?v="></script>
    
	<script src="./js/service/dashboards/dashboardChart.js?v="></script>
	<script src="./js/service/dashboards/dashboard.js?v="></script>
	
	<!-- 230103 Image Security 추가 -->
	<script src="./js/service/dashboards/imageSecurity/dashboardScanStatus.js?v="></script>
	<script src="./js/service/dashboards/clusterCompliance/dashboardClusterComplianceChart.js?v="></script>
	
</head>
<body>

<h1>Aegis ADMIN</h1>
<div class="skip_navigation">
	<ul>
		<li>
			<a href="#Content" class="go_content">본문 바로가기</a>
		</li>
		<li>
			<a href="#Gnb">메뉴 바로가기</a>
		</li>
	</ul>
</div>



<style>
	.header_box.on nav .lnb>li .depth2>li.has_children>a {
		pointer-events: auto;
		cursor: pointer;
	}
</style>
<header class="header_box">
<!--<div class="logo_box">
	<a href="./dashboard.do" class="logo_link">
		<div class="logo_hidden_box">
			<img src="./assets/images/logo.png" />
		</div>
	</a>
</div>-->
<nav>
	<ul class="lnb">
		<!-- 대시보드 -->
		<li class="active"><a href="./dashboard.do" class="menu01"><span>대시보드</span></a></li>
		<!-- 이벤트 모니터링 -->
		
		<li class=""><a href="./eventMonitoring.do" class="menu02"><span>이벤트 모니터링</span></a></li>
		<!-- 이벤트 조회 --> <!-- 230118 이벤트 모니터링(cAegis) 추가 -->
		<li class=""><a href="#" class="menu03"><span>이벤트 조회</span></a>
			<ul class="depth2">
				<li class=""><a href="#" class="menu03_1"><span>호스트 이벤트</span></a>
					<ul class="depth3">
						<!-- 호스트 이벤트 -->
						<li><a href="./eventFirewall.do" class=""><span>방화벽</span></a></li>
						<li><a href="./eventIPS.do" class=""><span>침입방지시스템</span></a></li>
						<li><a href="./eventMalware.do" class=""><span>멀웨어</span></a></li>
						<li><a href="./eventFileInt.do" class=""><span>파일 무결성</span></a></li>
						<li><a href="./eventFileCtl.do" class=""><span>실행 파일 통제</span></a></li>
						<li><a href="./eventPamAcl.do" class=""><span>서비스 제어</span></a></li>
					</ul>
				</li>
				<li class=""><a href="#" class="menu03_2"><span>클러스터 이벤트</span></a>
					<ul class="depth3">
						<!-- 클러스터 아벤트 -->
						<li><a href="./eventContainerSecurity.do" class=""><span>컨테이너 이벤트</span></a></li>
						<li><a href="./eventWorkload.do" class=""><span>컨테이너 워크로드 실행제어</span></a></li>
						<li><a href="./eventContainerImageControl.do" class=""><span>컨테이너 이미지 실행제어</span></a></li>
						<li><a href="./eventImageSecurity.do" class=""><span>컨테이너 이미지 스캔</span></a></li>
						<li><a href="./eventCompliance.do" class=""><span>클러스터 규정준수 스캔</span></a></li> 
					</ul>
				</li>
			</ul>
		</li>
		<!-- ?? -->
		
		<!-- 스캔 --> <!-- 230220 스캔 카테고리 추가(멀웨어는 vaegis 멀웨어 통합검사로 잠시 대체) -->
		<li class=""><a href="#" class="menu04"><span>스캔</span></a>
			<ul class="depth2">
				<li><a href="./complianceScan.do" class=""><span>클러스터 규정 준수</span></a></li>
				<li><a href="./imageScan.do" class=""><span>컨테이너 이미지</span></a></li>
				<li><a href="./cloudScan.do" class=""><span>호스트 안티 멀웨어</span></a></li>
				<li><a href="./vulnerability.do" class=""><span>호스트 취약성</span></a></li>
			</ul>
		</li>
		<!-- 정책관리 -->
		<li class=""><a href="#" class="menu06"><span>정책 관리</span></a>
			<ul class="depth2">
				<li class=""><a href="#" class="menu06_1"><span>호스트 정책</span></a>
					<ul class="depth3">
						<li><a href="./securityPolicy.do" class=""><span>탐지 룰 관리</span></a></li>
					</ul>
				</li>
				<li class=""><a href="#" class="menu06_2"><span>클러스터 정책</span></a>
					<ul class="depth3">
						<li><a href="./policyContainerSecurity.do" class=""><span>컨테이너 이벤트</span></a></li>
						<li><a href="./policyWorkload.do" class=""><span>컨테이너 워크로드 실행제어</span></a></li>
						<li><a href="./policyImageSecurity.do" class=""><span>컨테이너 이미지 스캔</span></a></li>
						<li><a href="./policyComplianceScan.do" class=""><span>클러스터 규정준수 스캔</span></a></li>
					</ul>
				</li>
				<li><a href="./cloudManager.do" class=""><span>자산 관리</span></a></li>
				<li><a href="./userManager.do" class=""><span>사용자 관리</span></a></li>
				<li><a href="./auditList.do" class=""><span>감사 로그</span></a></li>
						
				
			</ul>
		</li>
		<!-- 환경설정 -->
		<li class=""><a href="#" class="menu05"><span>환경 설정</span></a>
			<ul class="depth2">
				<li><a href="./authManager.do" class=""><span>메뉴 권한 설정</span></a></li>
				<li><a href="./siteManager.do" class=""><span>사이트 이용 설정</span></a></li>
			</ul>
		</li>
	</ul>
</nav>
</header>



<script type="text/javaScript">
$(document).ready(function() {
	cf_userInfoSet();
	lf_setUserInfo();
	lf_setTopCont();
	lf_initAlert();
	loadOTPData();
	
	var timer = setTimeout(function(){
    	checkPasswordHistory();
	}, 500);
});

var sync = 0;
function checkPasswordHistory() {
	if(!cf_getCookie("AUTHINFO")) return "";
	if(sync == 1) return; // 이미 조회 중
	
	if(cf_getCookie("PW_CHANGE")) { // 이미 조회 한적 있음(로그아웃 할 때 까지 유지)
		return;
	}
	
	sync = 1;
	var reqAsync,reqUrl,paramData;
	var callback = function(data) {
		var auditList = data.body.auditList
		if(auditList == null) return;
		
		if(auditList.length == 0) {
			$("a.modalLoad[rel='user_modal']").trigger("click");
			
			if(!$('.password_change_box').hasClass("on")) {
				$('.usr_password_change').trigger("click");
			}
			
			swal("비밀번호 변경","초기 패스워드를 변경하시기 바랍니다.", "./assets/images/icon_alert03.png", {
				buttons: "확인"
			});
		} else {
			console.log("init PW_CHANGE");
			cf_setCookie("PW_CHANGE", "" + auditList.length);
		}
	};
	var body = {};
	var reqTrid = _TR_N_PASSWORD_AUDIT_LIST;
	var Params={};
	
	if(!reqUrl) reqUrl = cf_getJsonUrl();
	if(typeof reqAsync == "undefined" ) reqAsync =  _ASYNC;
	if(!paramData) paramData = null;
	if(_IDPWSERVICE && _IDPWSERVICE[reqTrid]) {
		log("_IDPWSERVICE["+reqTrid+"]="+ _IDPWSERVICE[reqTrid]);
		if(!body.enc_userPasswd) {
			cf_certCheckDialogPopup(reqTrid,body,callback,reqAsync,reqUrl,paramData);
			return false;
		} else {
			Params['header'] = cf_jsonHeaderSet(reqTrid, body);
		}
	} else {
		Params['header'] = cf_jsonHeaderSet(reqTrid);
	}

	if(body) Params['body']= body;
	log('Params',Params);
	log('url',reqUrl);
	log('reqAsync',reqAsync);

	$.ajax({
	url :reqUrl,
	data : JSON.stringify(Params),
	async  : reqAsync ,
	type : "post",
	//dataType : "json",
	beforeSend : function(xhr) {
		xhr.setRequestHeader("Content-type", "application/json; charset=utf-8");
	},
	success:function(data, XMLHttpRequest, textStatus) {
		sync = 0;
		if("00000"!=data.header.rtnCode){ //서비스오류
			//cf_serviceCallError(data);
		} else {
			callback(data, body);
		}
	},
	error:function(XMLHttpRequest, textStatus, errorThrow) {
		sync = 0;
		//cf_alert('오류', "AJAX 요청 에러 메세지 : \n " + errorThrow);
	}
	});
}

function otpIssue() {
	var passwd = $('#otpPasswd').val();
	if(!passwd) {
		swal("QR 재발급","비밀번호를 입력해주세요","./assets/images/icon_alert03.png", {
	        icon: "error",
	        buttons:"확인"
	    });		
		return;
	}	
	
	swal("QR 재발급", "QR 재발급시 기존에 발행 된 OTP로 인증이 불가능해집니다. 진행하시겠습니까?", "./assets/images/icon_alert01.png", {
		buttons : [ "취소", "확인" ],
	}).then(function(will) {
		if(will) {   	
			var body = { "vender" : "totp" };
	    	body['userPasswd'] = Base64.encode(passwd);

	    	cf_requestServer(_TR_CURRENT_TOTPCODE_UPDATE, body, function(data) {
            	var body = data.body;
            	if(data.body['errorMsg']) {
	            	swal("QR 재발급", data.body['errorMsg'],"./assets/images/icon_alert03.png", {
				        icon: "error",
				        buttons:"확인"
				    });
            		return;
            	}
            	
            	loadOTPData();
            	            	
				swal("QR 재발급","정상적으로 처리되었습니다.","./assets/images/icon_alert02.png", {
			        icon: "success",
			        buttons:"확인"
			    });				    
			});
		} else {
	    	swal("QR 재발급", "취소하였습니다.", "./assets/images/icon_alert03.png", {
	    		buttons: "확인",
	    	});
	    }
	});
}

var timerId = null;
function lf_initAlert() {
	timerId = setInterval(lf_doConnect, 1000 * 1);
}

var wsocket = null;
function lf_doConnect() {
	if (wsocket != null)
		return;

	try {
		wsocket = new WebSocket((window.location.protocol == "http:" ? "ws" : "wss") + "://" + window.location.host + "/event.ws");
		wsocket.onopen = function() {
			clearInterval(timerId);
			console.log("연결");

			wsocket.onmessage = lf_onMessage;
			wsocket.onclose = lf_onClose;
			wsocket.onerror = lf_onError;

			lf_registTopic();
		};
	} catch (err) {
		console.log("연결실패");
		wsocket = null;
	}
}

function lf_registTopic() {
	var topicList = new Array();
	topicList.push(_TOPIC_ALERT);

	var headerJson = new Object();
	headerJson.wsId = _WS_SET; // SET:100001, ADD:100002, DEL:100003, GET:100004

	var bodyJson = new Object();
	bodyJson.topicList = topicList;

	var json = new Object();
	json.header = headerJson;
	json.body = bodyJson;

	if(wsocket != null) wsocket.send(JSON.stringify(json));
}


function lf_onMessage(evt) {
	//alert("onMessage->" + evt.data);
	var jsonData = JSON.parse(evt.data);
	if(Array.isArray(jsonData)) { // 실시간 이벤트 푸시
		var alertArray = lf_filter(jsonData, _TOPIC_ALERT);
		$.each(alertArray, function(idx, rowData) {
			if("EXPIRELICENSE" == rowData["kind"]) {
				swal("라이선스 위반", "라이선스가 만료되었습니다.\n" + "관리자에게 문의해주시기 바랍니다.\n", "./assets/images/icon_alert03.png", {
					buttons : "확인",
				});
			} else if ("NOTPROPERLICENSE" == rowData["kind"]) {
				swal("라이선스 위반", "라이선스가 올바르지 않습니다.\n" + "관리자에게 문의해주시기 바랍니다.\n", "./assets/images/icon_alert03.png", {
					buttons : "확인",
				});
			} else if ("AGENTFULLLICENSE" == rowData["kind"]) {
				swal("라이선스 위반", "사용 가능한 Agent를 초과했습니다.\n" + "관리자에게 문의해주시기 바랍니다.\n", "./assets/images/icon_alert03.png", {
					buttons : "확인",
				});
			} else if("LOCATION_HREF" == rowData["kind"]) {
    			swal("로그인 중복", "로그인이 해제됩니다.", "./assets/images/icon_alert03.png", {
					buttons: "확인",
		        });
		        console.log(rowData);
		        location.href = '/login.do';
    		} else {
				console.log(rowData);
			}
		});
	}
}

function lf_filter(jsonArray, TOPIC) {
	var rArray = new Array();
	for(var i = 0; i < jsonArray.length; i++) {
		var jsonObj = jsonArray[i];
		var className = jsonObj['class'];

		if(className == TOPIC) rArray.push(jsonObj);
	}
	return rArray;
}

function lf_onClose(evt) {
	console.log("연결 끊김");
	wsocket = null;
	lf_initAlert();
}

function lf_onError(evt) {
	console.log("Error : " + evt);
}

function lf_setUserInfo() {
	$('#currentUserId').attr('title', _USER.getUserId());
	$('#currentUserId').text(_USER.getUserKnm());
	$('.modal_cont #currentUserId').val(_USER.getUserId());
	$('.modal_cont #currentUserName').val(_USER.getUserKnm());
	$('.modal_cont #currentUserPhone').val(_USER.getUserPhone());
	$('.modal_cont #currentUserEmail').val(_USER.getUserEmail());
	$('.modal_cont #userPasswd').val('');
	$('.modal_cont #userPasswd1').val('');
	$('.modal_cont #userPasswd2').val('');
	
	if(_USER.getAuthKey() == _USERLEVEL_SUPER_ADMIN) {
		$('.modal_cont .current').text('SUPER ADMIN');
	} else if(_USER.getAuthKey() == _USERLEVEL_ADMIN) {
		$('.modal_cont .current').text('ADMIN');
	} else if(_USER.getAuthKey() == _USERLEVEL_OPERATOR) {
		$('.modal_cont .current').text('Operator');
	} else {
		$('.modal_cont .current').text('Viewer');
	}
}

function loadOTPData() {
	var body = { "vender" : "totp" };
	cf_requestServer(_TR_CURRENT_TOTPCODE_LIST, body, function(data) {
		var otpData = data.body.result;
		$('#otpQRCode').text(otpData['data']);
		$('#otpUserid').val(otpData['id']);
		$('#otpCompany').val(otpData['company']);
		$('#otpPasswd').val('');
		$('#otpCreatetime').val(otpData['createtime']);

		$("#otpQRImg").attr("src", "/otp/qrcode.do?" + new Date().getTime());
	});	
}

function updateCurrentUser() {
	var body = {};
	body['currentUserId'] = $('.modal_cont #currentUserId').val();
	body['currentUserName'] = $('.modal_cont #currentUserName').val();
	body['currentUserPhone'] = $('.modal_cont #currentUserPhone').val();
	body['currentUserEmail'] = $('.modal_cont #currentUserEmail').val();

	var password = $('.modal_cont #userPasswd').val();
	var password1 = $('.modal_cont #userPasswd1').val();
	var password2 = $('.modal_cont #userPasswd2').val();

	if(body['currentUserName'].length > 20) {
		swal("", "사용자 이름은 20글자 이내여야 합니다.", "", {
			buttons : "확인"
		});
		return;
	}

	if(!/[0-9]{2,3}-[0-9]{3,4}-[0-9]{3,4}$/.test(body['currentUserPhone'])) {
		swal("", "올바른 형식의 전화번호를 입력해주세요.(ex : 010-0000-0000)", "", {
			buttons : "확인"
		});
		return;
	}

	if(!/^[0-9a-zA-Z]([-_.]?[0-9a-zA-Z])*@[0-9a-zA-Z]([-_.]?[0-9a-zA-Z])*.[a-zA-Z]{2,3}$/i.test(body['currentUserEmail'])) {
		swal("", "올바른 형식의 이메일을 입력해주세요.(ex : aegis@sgacorp.kr)", "", {
			buttons : "확인"
		});
		return;
	}

	if(password.length < 1) {
		swal("", "비밀번호를 입력하세요", "", {
			buttons : "확인"
		});
		return false;
	}

	body['userPasswd'] = Base64.encode(password);
	if($('.password_change_box').hasClass('on')) {
		if(checkPassword(password, password1, password2)) {
			body['userNewPasswd'] = Base64.encode(password1);
		} else {
			return false;
		}
	}

	swal("사용자 정보 변경", "사용자정보를 변경하시겠습니까?", "./assets/images/icon_alert01.png", {
		buttons : [ "취소", "확인" ],
	}).then(function(will) {
		if(will) {
			cf_requestServer(_TR_CURRENT_USER_UPDATE, body, function(data) {
				lf_serviceCall500012CallBack(data);
			});
		} else {
	    	swal("사용자 정보 변경", "취소하였습니다.", "./assets/images/icon_alert03.png", {
	    		buttons: "확인",
	    	});
	    }
	});
}

function lf_serviceCall500012CallBack(data) {
	swal("사용자 정보 변경", "사용자 정보가 정상적으로 변경 되었습니다.", "./assets/images/icon_alert02.png", {
		buttons : "확인"
	});

	//_AUTHINFO = data.body.authToken;
	var _authinfo = cf_getCookie("AUTHINFO");
	_authinfo = Base64.decode(_authinfo);
	var authArray = _authinfo.split('|');

	cf_setCookie("AUTHINFO", Base64.encode(authArray[0] + "|"
			+ authArray[1] + "|" + authArray[2] + "|"
			+ data.body.currentUserName + "|" + authArray[4] + "|"
			+ authArray[5] + "|" + data.body.currentUserPhone + "|"
			+ data.body.currentUserEmail));
	cf_userInfoSet();
	lf_setUserInfo();
	
	closeUserModal();
}

function checkPassword(password, password1, password2) {
	var reg = /^(?=.*?[a-z])(?=.*?[A-Z])(?=.*?[0-9])(?=.*?[#?!@$%^&*-`]).{9,20}$/;
	if(password1 == '') {
		swal("", "신규 비밀번호를 입력하여 주세요.", "", {
			buttons:"확인"
		});
		return false;   
	} else if(password1.length < 9 || password1.length > 20) { // 3. 비밀번호 길이
		swal("", "비밀번호는 9~20글자여야 하며, 숫자/알파벳/특수문자를 모두 포함해야 합니다.", "", {
			buttons:"확인"
		});
		return false;    
	} else if(!reg.test(password1)){   
		swal("", "비밀번호는 9~20글자여야 하며, 숫자/알파벳/특수문자를 모두 포함해야 합니다.", "", {
			buttons:"확인"
		});
		return false;
	} else if(password1.search(/\s/) != -1) { // 1. empty check 
		swal("", "비밀번호에 공백을 제거해주세요.", "", {
			buttons:"확인"
		});
		return false;
	} else if(password1 != password2) { // 2. 비밀번호 일치
		swal("", "입력한 비밀번호와 재입력 비밀번호가 일치하지 않습니다.", "", {
			buttons:"확인"
		});
		return false;
	} else if(password == password1) {
		swal("", "이전 비밀번호가 동일한 비밀번호는 사용 하실 수 없습니다.", "", {
			buttons:"확인"
		});
		return false;
	}

	var iter = /(.)\1{1,}/;
	if(iter.test(password1)) {
		swal("", "비밀번호에 동일한 문자를 연속해서 사용할 수 없습니다.", "", {
			buttons:"확인"
		});
		return false;
	} else if(checkSeq(password1)) {
		swal("", "비밀번호에 키보드 연속 된 문자를 사용 할 수 없습니다.", "", {
			buttons:"확인"
		});
		return false;
	}
	return true;    
}

function checkSeq(str) {
	var max = 3; // 3자리 이상 검사
	var i, j, k, x, y;
	var buff = [ "0123456789", "abcdefghijklmnopqrstuvwxyz", "ABCDEFGHIJKLMNOPQRSTUVWXYZ", "qwertyuiopasdfghjklzxcvbnm", "QWERTYUIOPASDFGHJKLZXCVBNM"];

	var scr, src2, ptn = "";
	for(i = 0; i < buff.length; i++) {
		src = buff[i];
		src2 = buff[i] + buff[i];

		for(j = 0; j < src.length; j++) {
			x = src.substr(j, 1);
			y = src2.substr(j, max);
			ptn += "[" + x + "]{" + max + ",}|";
			ptn += y + "|";

		}
	}
	ptn = new RegExp(ptn.replace(/.$/, ""));

	if(ptn.test(str)) return true;
	return false;
}

function closeUserModal() {
	removeUserDim();
	$('#user_modal').removeClass('open');
	$("#user_modal").hide();
	var isVisible = $('#user_modal').is(':visible');
	var modalLength = $('.modal:visible').length;

	if (isVisible) {
		if (modalLength > 1) {
			$('#user_modal').fadeOut(250);
		} else {
			$('.dim').fadeOut(250);
		}
	}
}

function removeUserDim(){
	$('.password_change_box').removeClass('on');

	$('.dim').fadeOut(250);
	if (window.matchMedia('(min-width: 1340px) and (max-width: 1920px)').matches){
		$('body').css({
			overflow : 'inherit'
		}).bind('touchmove', function(e) {
			e.preventDefault();
		});
	}
	if (window.matchMedia('(min-width: 0) and (max-width: 1340px)').matches){
		$('body').css({
			overflowX : 'auto'
		}).bind('touchmove', function(e) {
			e.preventDefault();
		});
	}

	var timer = setTimeout(function(){
		checkPasswordHistory();
	}, 1000);
}

function lf_setTopCont(){
	$('#topContList').empty();

	$('#topCont').removeClass('disabled');
	$('#topCont > .top_dashboard_link').prop('disabled', false);
	
	if(_USER.getAuthKey() == USER_LEVEL_SUPERADMIN_CODE){
		//$('#topContList').append($('<li><a href="#" onclick="javascript: lf_dashboardPublicDialog();">저장된 대시보드 보기</a></li>'));
		$('#topContList').append($('<li><a href="#" onclick="javascript: lf_saveEventFunc();">대시보드 저장</a></li>'));
		//$('#topContList').append($('<li><a href="#" onclick="javascript: lf_serviceCall600103();">대시보드 삭제</a></li>'));
		//$('#topContList').append($('<li><a href="#" onclick="javascript: lf_dashboardPublicSaveDialog();">공용 대시 보드 등록</a></li>'));
		//$('#topContList').append($('<li><a href="#" onclick="javascript: lf_dashboardAdminDialog();">모든 대시보드 보기</a></li>'));
	} else if(_USER.getAuthKey() == USER_LEVEL_ADMIN_CODE){
		//$('#topContList').append($('<li><a href="#">저장된 대시보드 보기</a></li>'));
		$('#topContList').append($('<li><a href="#">대시보드 저장</a></li>'));
		//$('#topContList').append($('<li><a href="#">대시보드 삭제</a></li>'));
	} else if(_USER.getAuthKey() == USER_LEVEL_OPERATOR_CODE){
		//$('#topContList').append($('<li><a href="#">저장된 대시보드 보기</a></li>'));
		$('#topContList').append($('<li><a href="#">대시보드 저장</a></li>'));
		//$('#topContList').append($('<li><a href="#">대시보드 삭제</a></li>'));
	} else{
		//$('#topContList').append($('<li><a href="#">저장된 대시보드 보기</a></li>'));
		$('#topContList').append($('<li><a href="#">대시보드 저장</a></li>'));
		//$('#topContList').append($('<li><a href="#">대시보드 삭제</a></li>'));
	}

}
</script>

<article class="top_cont">
	<!--s : 2023-09-20 로고 위치이동-->
	<a href="/dashboard.do" class="logo_link">
		<div class="logo_hidden_box">
			<img src="/assets/images/common/img_aegis.png">
		</div>
	</a>
	<!--e : 2023-09-20 로고 위치이동-->
	<div class="location">
		<ul><li>Home</li><li>대시보드</li></ul><h2>대시보드</h2>
	</div>
	<div class="user_box">
		<div class="user_info">
			<a href="#" class="user_info_link">
				<p class="user">Hello, <span id="currentUserId"></span></p>
			</a>
			<div class="user_info_list">
				<ul>
					<li><a href="#" rel="user_modal" class="modalLoad">내정보</a></li>
					<li><a href="#" rel="tf_modal" class="modalLoad">2차인증</a></li>
					<li class="logout"><a href="javascript:cf_serviceCall100002();">로그아웃</a></li>
				</ul>
			</div>
		</div>
		<div class="top_dashboard ">
			<a href="#" class="top_dashboard_link">
				<span class="linktext">사용자 정보 버튼</span>
			</a>
		</div>
		<div class="top_dashboard_list">
			<ul id="topContList">
				<!-- li><a href="javascript: lf_dashboardPublicSaveDialog();">공용 대시 보드 등록</a></li>
				<li><a href="javascript: lf_dashboardAdminDialog();">모든 대시보드 보기</a></li>
				<li><a href="javascript: lf_dashboardPublicDialog();">저장된 대시보드 보기</a></li>
				<li><a href="javascript: lf_saveEventFunc();">대시보드 저장</a></li>
				<li><a href="javascript: lf_serviceCall600103();">대시보드 삭제</a></li -->
			</ul>
		</div>
	</div>
</article>

<!--  modal :: 내정보 팝업  -->
<div class="modal small" id="user_modal">
	<div class="modal_header">
		<h3>내정보</h3>
	</div>
	<div class="modal_body">
		<div class="modal_cont">
			<dl>
				<dt>
					<span>사용자 권한</span>
				</dt>
				<dd>
					<div class="sel_box">
						<select class="popup_sel disabled" id="authKey">
							<option value="0000A399X999">SUPER ADMIN</option>
							<option value="0000A499X999">ADMIN</option>
							<option value="0000A599X999">Operator</option>
							<option value="0000A699X999">Viewer</option>
						</select>
					</div>
				</dd>
			</dl>
			<dl>
				<dt>
					<span>User ID</span>
				</dt>
				<dd>
					<div class="ipt_box">
						<input class="no_radius" type="text" readonly="" value="aptcastle"  id="currentUserId">
					</div>
				</dd>
			</dl>
			<dl>
				<dt>Password</dt>
				<dd>
					<div class="ipt_box password">
						<input class="no_radius" type="password" placeholder="기존 비밀번호를 입력해 주세요." id="userPasswd">
						<a href="#" class="btn usr_password_change password_change" style="height: 34px; line-height: 30px; border-radius: 17px; border: 2px solid #2e6fd4; color: #fff; font-size: 13px;">비밀번호변경</a>
					</div>
					<div class="password_change_box">
						<div class="ipt_box">
							<input class="no_radius" type="password" placeholder="신규 비밀번호를 입력해 주세요." id="userPasswd1">
						</div>
						<div class="ipt_box">
							<input class="no_radius" type="password" placeholder="신규 비밀번호를 다시한번 입력해 주세요." id="userPasswd2">
						</div>
					</div>
				</dd>
			</dl>
			<dl>
				<dt>
					<span>User Name</span>
				</dt>
				<dd>
					<div class="ipt_box">
						<input class="no_radius" type="text" placeholder="사용자의 이름을 입력해주세요." value="auditcastle Maker" id="currentUserName">
					</div>
				</dd>
			</dl>
			<dl>
				<dt>
					<span>User Phone</span>
				</dt>
				<dd>
					<div class="ipt_box">
						<input class="no_radius" type="text" placeholder="연락처를 입력해 주세요." value="010-0000-0000" id="currentUserPhone">
					</div>
				</dd>
			</dl>
			<dl>
				<dt>
					<span>User Email</span>
				</dt>
				<dd>
					<div class="ipt_box">
						<input class="no_radius" type="text" placeholder="이메일를 입력해 주세요." value="auditcastle@sgacorp.co.kr" id="currentUserEmail">
					</div>
				</dd>
			</dl>
		</div>
	</div>
	<div class="modal_footer">
		<div class="btn_wrap">
			<a href="javascript:closeUserModal();" class="btn grey">취소</a>
			<a href="javascript:updateCurrentUser();" class="btn">수정</a>
		</div>
	</div>
	<div class="modal_controller">
		<a href="#" class="close">close</a>
	</div>
</div>

<div class="modal small" id="tf_modal">
	<div class="modal_header">
		<h3>OTP 정보</h3>
	</div>
	<div class="modal_body">
		<div class="modal_cont">
			<dl>
				<dt>
					<span>QR Code</span>					
				</dt>
				<dd>
					<div class="ipt_box">
						<img id="otpQRImg" src="/otp/qrcode.do" width="120" height="120" loading="lazy"/>
						<span id="otpQRCode" class="qrcode super_bg">Unknown</span>
					</div>
				</dd>
			</dl>
			<dl>
				<dt>
					<span>User ID</span>
				</dt>
				<dd>
					<div class="ipt_box">
						<input class="no_radius" type="text" readonly="" value=""  id="otpUserid">
					</div>
				</dd>
			</dl>
			<dl>
				<dt>Password</dt>
				<dd>
					<div class="ipt_box password">
						<input class="no_radius" type="password" placeholder="비밀번호를 입력해 주세요." id="otpPasswd">
						&nbsp;<a href="javascript:otpIssue();" class="btn otp_change_box otp_change" style="height: 34px; line-height: 30px; border-radius: 17px; border: 2px solid #2e6fd4; color: #fff; font-size: 13px;">QR 재발급</a>
					</div>
				</dd>
			</dl>
			<dl>
				<dt>
					<span>발급처</span>
				</dt>
				<dd>
					<div class="ipt_box">
						<input class="no_radius" type="text" placeholder="" value="" id="otpCompany" readonly>
					</div>
				</dd>
			</dl>
			<dl>
				<dt>
					<span>발급일</span>
				</dt>
				<dd>
					<div class="ipt_box">
						<input class="no_radius" type="text" placeholder="" value="" id="otpCreatetime" readonly>
					</div>
				</dd>
			</dl>			
		</div>
	</div>
	<div class="modal_footer">
		<div class="btn_wrap">
			<a href="#" class="btn grey close">닫기</a>
		</div>
	</div>
	<div class="modal_controller">
		<a href="#" class="close">close</a>
	</div>
</div>
	

<section class="securitypolicy_page mscrollbar">
	<div class="sub">
		<div class="securitypolicy_box">
			<div id="registry_policy_title" class="securitypolicy_title cluster_policy_title">
				<div class="securitypolicy_title_left">
					<h3>컨테이너 워크로드 실행제어</h3>
					<dl class="fl">
						<dt>총개수</dt>
						<dd id="registry_policy_cnt"></dd>
					</dl>
				</div>
				<div class="securitypolicy_title_middle cluster_policy_title_middle">
					<div class="fl">
						<div class="event_sel">
							<div class="sel_box">
								<select id="selectClusterUuid" onchange="updateTableByCluster()" class="wide event cluster_selecteBox" style="display: none;">
									<option value="53596b7c-dde6-4a04-ada6-ffa143a9728a">Cluster-61</option>
									<option value="d6d0d94e-a8e5-410e-890d-9636b9ecad6b">Cluster-64</option>
									<option value="2f4b443e-d0c4-455f-9664-c6f6fbe5f5d1">Cluster-67</option>
									<option value="73f67fc0-949a-4527-9a27-ccf35ad2c527">K8S v1.19.14_Cluster</option>
									<option value="e957fea2-1f6a-4ae2-931f-8a5ee1228c4d">Openshift-240</option>
								</select>
							</div>
						</div>
					</div>
					<div class="fl">
						<div class="ipt_box">
							<input class="" type="text" placeholder="Rule Name을 입력하여 주십시오." id="searchKeyword" name="searchKeyword" />
						</div>
						<a id="searchBtn" href="#" class="btn serch">검색</a>
					</div>
				</div>
				<div class="securitypolicy_title_right cluster_policy_title_right">
					<div class="fl">
						<a id="policyUpdate" href="#" class="btn line def add" rel="workLoad_policy_add" name="workLoad">정책추가</a>
					</div>
				</div>
			</div>
			<div id="containerSecurityPolicyTree">
				<div id="registry_policy_contain">
					<div id="workLoadTbl" class="tbl">
						<table id="workLoad_policy_table" class="dataTable no-footer" role="grid" aria-describedby="workLoad_policy_table_info">
								<colgroup>
									<col width="6%">
									<col width="10%">
									<col width="24%">
									<col width="10%">
									<col width="10%">
									<col width="10%">
									<col width="10%">
									<col width="10%">
									<col width="10%">
								</colgroup>
								<thead>
									<tr role="row"><th class="sorting" tabindex="0" aria-controls="workLoad_policy_table" rowspan="1" colspan="1" aria-label="No: activate to sort column ascending">No</th><th class="sorting" tabindex="0" aria-controls="workLoad_policy_table" rowspan="1" colspan="1" aria-label="Type: activate to sort column ascending">Type</th><th class="sorting" tabindex="0" aria-controls="workLoad_policy_table" rowspan="1" colspan="1" aria-label="Rule Name: activate to sort column ascending">Rule Name</th><th class="sorting" tabindex="0" aria-controls="workLoad_policy_table" rowspan="1" colspan="1" aria-label="Action: activate to sort column ascending">Action</th><th class="sorting" tabindex="0" aria-controls="workLoad_policy_table" rowspan="1" colspan="1" aria-label="Enabled: activate to sort column ascending">Enabled</th><th class="sorting" tabindex="0" aria-controls="workLoad_policy_table" rowspan="1" colspan="1" aria-label="Updated User: activate to sort column ascending">Updated User</th><th class="sorting" tabindex="0" aria-controls="workLoad_policy_table" rowspan="1" colspan="1" aria-label="Created Date: activate to sort column ascending">Created Date</th><th class="sorting" tabindex="0" aria-controls="workLoad_policy_table" rowspan="1" colspan="1" aria-label="Updated Date: activate to sort column ascending">Updated Date</th><th class="sorting_disabled" rowspan="1" colspan="1" aria-label="Operation">Operation</th></tr>
								</thead>
								<tbody><tr role="row" class="odd"><td>1</td><td title="CUSTOM" style="white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">CUSTOM</td><td title="Namespace[intig2-ns] :: for TEST" style="white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">Namespace[intig2-ns] :: for TEST</td><td title="ALLOW" style="white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">ALLOW</td><td title="적용" style="white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">적용</td><td title="jypark0125" style="white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">jypark0125</td><td title="2023-12-07 14:33:52" style="white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">2023-12-07 14:33:52</td><td title="2023-12-07 14:33:52" style="white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">2023-12-07 14:33:52</td><td><input type="hidden" name="workLoadData" value="{&quot;policy_type&quot;:&quot;CUSTOM&quot;,&quot;is_activated&quot;:&quot;T&quot;,&quot;updated_at&quot;:&quot;2023-12-07 14:33:52&quot;,&quot;cluster_uuid&quot;:&quot;53596b7c-dde6-4a04-ada6-ffa143a9728a&quot;,&quot;policy_description&quot;:&quot;Namespace[intig2-ns]- for TEST&quot;,&quot;updated_by&quot;:&quot;jypark0125&quot;,&quot;policy_name&quot;:&quot;Namespace[intig2-ns] :: for TEST&quot;,&quot;created_at&quot;:&quot;2023-12-07 14:33:52&quot;,&quot;policy_action&quot;:&quot;ALLOW&quot;,&quot;uuid&quot;:&quot;dd9f59a1-636f-4233-b617-b5ae5bf86a8c&quot;}"><a href="#" class="btn icon edit" rel="workLoad_policy_edit" name="workload"> </a><a class="btn icon del" rel="workLoad_policy_del"> </a></td></tr><tr role="row" class="even"><td>2</td><td title="CUSTOM" style="white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">CUSTOM</td><td title="Cluster policy: All Deny" style="white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">Cluster policy: All Deny</td><td title="DENY" style="white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">DENY</td><td title="적용" style="white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">적용</td><td title="jypark0125" style="white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">jypark0125</td><td title="2023-12-06 15:29:49" style="white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">2023-12-06 15:29:49</td><td title="2023-12-06 15:29:49" style="white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">2023-12-06 15:29:49</td><td><input type="hidden" name="workLoadData" value="{&quot;policy_type&quot;:&quot;CUSTOM&quot;,&quot;is_activated&quot;:&quot;T&quot;,&quot;updated_at&quot;:&quot;2023-12-06 15:29:49&quot;,&quot;cluster_uuid&quot;:&quot;53596b7c-dde6-4a04-ada6-ffa143a9728a&quot;,&quot;policy_description&quot;:&quot;Cluster policy&quot;,&quot;updated_by&quot;:&quot;jypark0125&quot;,&quot;policy_name&quot;:&quot;Cluster policy: All Deny&quot;,&quot;created_at&quot;:&quot;2023-12-06 15:29:49&quot;,&quot;policy_action&quot;:&quot;DENY&quot;,&quot;uuid&quot;:&quot;a01e8b8d-e3fc-4e8e-955c-a95d6f134558&quot;}"><a href="#" class="btn icon edit" rel="workLoad_policy_edit" name="workload"> </a><a class="btn icon del" rel="workLoad_policy_del"> </a></td></tr><tr role="row" class="odd"><td>3</td><td title="CUSTOM" style="white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">CUSTOM</td><td title="Namespace[monitoring]: For Prometheus" style="white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">Namespace[monitoring]: For Prometheus</td><td title="ALLOW" style="white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">ALLOW</td><td title="적용" style="white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">적용</td><td title="jypark0125" style="white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">jypark0125</td><td title="2023-12-06 14:01:47" style="white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">2023-12-06 14:01:47</td><td title="2023-12-06 14:01:47" style="white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">2023-12-06 14:01:47</td><td><input type="hidden" name="workLoadData" value="{&quot;policy_type&quot;:&quot;CUSTOM&quot;,&quot;is_activated&quot;:&quot;T&quot;,&quot;updated_at&quot;:&quot;2023-12-06 14:01:47&quot;,&quot;cluster_uuid&quot;:&quot;53596b7c-dde6-4a04-ada6-ffa143a9728a&quot;,&quot;policy_description&quot;:&quot;Promethus&quot;,&quot;updated_by&quot;:&quot;jypark0125&quot;,&quot;policy_name&quot;:&quot;Namespace[monitoring]: For Prometheus&quot;,&quot;created_at&quot;:&quot;2023-12-06 14:01:47&quot;,&quot;policy_action&quot;:&quot;ALLOW&quot;,&quot;uuid&quot;:&quot;c94a79df-2569-4cea-8071-66875ceb9e12&quot;}"><a href="#" class="btn icon edit" rel="workLoad_policy_edit" name="workload"> </a><a class="btn icon del" rel="workLoad_policy_del"> </a></td></tr><tr role="row" class="even"><td>4</td><td title="CUSTOM" style="white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">CUSTOM</td><td title="Namespace[sga-ns] :: policy" style="white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">Namespace[sga-ns] :: policy</td><td title="ALLOW" style="white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">ALLOW</td><td title="적용" style="white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">적용</td><td title="jypark0125" style="white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">jypark0125</td><td title="2023-12-06 14:00:50" style="white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">2023-12-06 14:00:50</td><td title="2023-12-06 14:00:50" style="white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">2023-12-06 14:00:50</td><td><input type="hidden" name="workLoadData" value="{&quot;policy_type&quot;:&quot;CUSTOM&quot;,&quot;is_activated&quot;:&quot;T&quot;,&quot;updated_at&quot;:&quot;2023-12-06 14:00:50&quot;,&quot;cluster_uuid&quot;:&quot;53596b7c-dde6-4a04-ada6-ffa143a9728a&quot;,&quot;policy_description&quot;:&quot;Namespace policy&quot;,&quot;updated_by&quot;:&quot;jypark0125&quot;,&quot;policy_name&quot;:&quot;Namespace[sga-ns] :: policy&quot;,&quot;created_at&quot;:&quot;2023-12-06 14:00:50&quot;,&quot;policy_action&quot;:&quot;ALLOW&quot;,&quot;uuid&quot;:&quot;c5128400-4c2b-4940-8119-1f158dcaadf1&quot;}"><a href="#" class="btn icon edit" rel="workLoad_policy_edit" name="workload"> </a><a class="btn icon del" rel="workLoad_policy_del"> </a></td></tr></tbody>
							</table>
					</div>
				</div>
			</div>
		</div>
	</div>
</section>

<!--s : 정책추가 팝업 -->
<div id="workLoad_policy_edit" class="modal mid win_popup rec mscrollbar" style="height:100%; width:1000px; display:block;">
	<input type="hidden" id="selectedClusterUuid" value="" />
	<input type="hidden" id="clusterInfo" value="" />
	<input type="hidden" id="clusterSubjectInfo" value="" />
	<input type="hidden" id="clusterCsPolicyInfo" value="" />

	<h4 id="title" data-type="">컨테이너 워크로드 실행제어</h4>
	<div class="popup_view_cont">
		<div class="securitypolicy_popup_box">
			<div class="securitypolicy_top" style="padding-top: 0px">
				<div class="securitypolicy_top_info">
					<div class="policy_title_box" style="padding-top: 0px">
						<p class="policy_title">Rule Name</p>
						<div class="ipt_box" style="padding-right: 20px">
							<input type="text" id="workload_rulename" value="" placeholder="" class="no_radius" />
						</div>
						<label class="switch-button"> <input id="workload_isactive" type="checkbox" /> <span class="onoff-switch"></span>
						</label>
					</div>

					<div class="policy_title_box">
						<p class="policy_title">Description</p>
						<div class="ipt_box">
							<input type="text" id="workload_description" value="" placeholder="" class="no_radius" />
						</div>
					</div>

					<div class="policy_title_box">
						<p class="policy_title">Cluster</p>
						<div class="sel_box">
							<select id="wh_cluster" class="popup_sel">
								<!-- <option value="" disabled selected style="display: none">적용할 Cluster를 선택해 주십시오</option> -->
							</select>
						</div>

						<p class="policy_title" style="padding-left: 30px">Action</p>
						<div class="sel_box">
							<select id="workload_action" class="popup_sel" s>
								<option value="DENY" selected="selected">Deny</option>
								<option value="ALLOW">Allow</option>
								<!-- <option value="LOGGING">Logging</option> -->
							</select>
						</div>
					</div>
				</div>
			</div>
			<div id="workLoadPolicyInfo" class="securitypolicy_bottom" style="padding-top: 10px">
				<div class="securitypolicy_bottom_info">
					<div class="policy_title_box" style="padding-top: 0px">
						<p class="policy_title">Scope</p>
						<div class="policy_body">
							<div id="policy_scopeOption">
								<div class="policy_option">
									<p>Cluster</p>
									<div class="ipt_box" style="margin-right: 10px">
										<input type="text" value="" class="selected_cluster no_radius" readonly />
									</div>
									<p>Namespace</p>
									<div class="ipt_box">
										<input type="text" placeholder="" class="no_radius" name="namespace" />
									</div>
									<a id="scopeOption" class="btn icon add" onclick="plusOptionWorkload(this.id)">추가</a>
								</div>
							</div>
							<p class="policy_explain">Cluster 정책이 Namespace 정책보다 우선 적용 됩니다.</p>
						</div>
					</div>
				</div>
				
				<div class="securitypolicy_bottom_info">
					<div class="policy_title_box">
						<p class="policy_title"></p>
						<div class="policy_body">
							<p class="policy_explain" style="padding:0;">네임스페이스 정책일 경우 동일한 주체에 대한 정책이 여러개일 경우 Deny 정책이 우선 적용됩니다.</p>
						</div>
					</div>
					
					<div class="policy_title_box">
						<p class="policy_title">Subjects</p>
						<div class="policy_body">
							<div style="display: flex; margin-top: 10px; margin-bottom: 10px">
								<p>Account 정보를 최신화 합니다</p>
								<a class="update" onclick="updateClusterSubjectList()"></a>
							</div>
							<div id="policy_subjectOption">
								<div class="policy_option">
									<div class="sel_box">
										<select id="wh_subject_type_0" class="popup_sel" name="wh_subject_type"></select>
									</div>
									<div id="subject_info_box_0" class="sel_box" style="display: none">
										<select id="wh_subject_info_0" class="popup_sel" name="wh_subject_info"></select>
									</div>
									<div id="subjectOption_ipt_0" class="ipt_box" style="display: none">
										<input type="text" value="" placeholder="" class="no_radius" name="wh_subject_input" />
									</div>
									<a id="subjectOption" class="btn icon add" onclick="plusOptionWorkload(this.id)">추가</a>
								</div>
							</div>
							<p class="policy_explain">실행하고자 하는 주체(User,Group,ServiceAccount,System,Process) 정보를 입력합니다.</p>
						</div>
					</div>

					<div class="policy_title_box">
						<p class="policy_title">Resources</p>
						<div class="policy_body">
							<div id="policy_resourceOption">
								<div class="policy_option">
									<div class="sel_box">
										<select id="wh_resources_0" class="popup_sel"></select>
									</div>
									<div id="resourceOption_ipt_0" class="ipt_box" style="display: none">
										<input type="text" value="" placeholder="" class="no_radius" />
									</div>
									<a id="resourceOption" class="btn icon add" onclick="plusOptionWorkload(this.id)">추가</a>
								</div>
							</div>
							<p class="policy_explain">실행 제어 하고자 하는 Kubernetes Resource를 선택합니다.</p>
						</div>
					</div>

					<div class="policy_title_box">
						<p class="policy_title">Operations</p>
						<div class="policy_body">
							<div id="policy_operationsOption">
								<div class="policy_option">
									<div class="sel_box">
										<select id="wh_operations_0" class="popup_sel"></select>
									</div>
									<div id="operationsOption_ipt_0" class="ipt_box" style="display: none">
										<input type="text" value="" placeholder="" class="no_radius" />
									</div>
									<a id="operationsOption" class="btn icon add" onclick="plusOptionWorkload(this.id)">추가</a>
								</div>
							</div>
							<p class="policy_explain">제어할 Operation을 선택합니다.</p>
						</div>
					</div>
				</div>
									
				<div class="securitypolicy_bottom_info">
					<div class="policy_title_box" style="padding-bottom: 0px">
						<div class="policy_box">
							<input type="checkbox" id="wh_validation" />
							<label for="wh_validation" style="color: #e5e5e5; font-size: 13px; font-weight: 400"> 보안 표준 규정준수 검증</label>
						</div>
					</div>
					<div class="policy_title_box">
						<div id="complianceBox" class="policy_body" style="align-items: center">
							<div style="display: flex; align-items: center">
								<!-- 0707 사용자 규정준수 추가 -->
								<div class="cs_compliance_box sel_box" style="min-width: 220px; margin-right: 10px">
									<select id="cs_complicance" class="popup_sel"></select>
								</div>
								<p>Fail Controls의 갯수가</p>
								<div class="sel_box" style="min-width: 200px; margin-right: 10px">
									<select id="cs_complianceCondition" class="popup_sel">
										<option value="EQUAL" selected="selected">equals(=)</option>
										<option value="LOW">less than(&lt;)</option>
										<option value="EQUAL_LOW">less than or equals(&lt;=)</option>
										<option value="HIGH">greater than(&gt;)</option>
										<option value="EQUAL_HIGH">greater than or equals(&gt;=)</option>
									</select>
								</div>
								<div class="ipt_box" style="margin-right: 10px">
									<input type="text" id="cs_failCount" value="" class="no_radius" />
								</div>
								<p>인지 확인 합니다.</p>
							</div>
							<p id="cs_failMessage" style="color:red; margin-top:10px; display:none">클러스터에 설정된 규정 준수 스캔 정책이 존재하지 않습니다.</p>
						</div> 
					</div>
				</div>
				
				<div class="securitypolicy_bottom_info">
					<div class="policy_title_box" style="padding:0px;">
						<div class="policy_box">
							<input type="checkbox" id="wh_assurenced" />
							<label for="wh_assurenced" style="color: #e5e5e5; font-size: 13px; font-weight: 400"> 보증된 컨테이너 이미지 사용을 확인합니다.</label>
						</div>
					</div>
				</div>
				

					<div class="policy_btn_box">
						<a href="javascript:lf_closeWorkLoadPolicyModal();" class="btn" style="margin-right: 30px">취소</a>
						<a href="#" id="wh_policy_add" class="btn" onclick="plusPolicyWorkload()">확인</a>
					</div>
			</div>
		</div>
	</div>

	<div class="modal_controller" style="margin: 8px">
		<a href="javascript:lf_closeWorkLoadPolicyModal();" class="close">close</a>
	</div>
</div>
<div class="dim"></div>
<!--e : 정책추가 팝업 -->




</body>
</html>

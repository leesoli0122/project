<%@page language="java" contentType="text/html; charset=utf-8" pageEncoding="UTF-8"%>
<!DOCTYPE html>
<html lang="ko">

<head>
	<title>멀웨어 예외 설정 - Aegis</title>
	<meta charset="UTF-8" http-equiv="Content-Type">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=3.0">
	<meta name="mobile-web-app-capable" content="yes">
	<meta name="format-detection" content="telephone=no" />
	
	<!-- TODO: search engine info -->
	<meta name="robots" content="Aegis" />
	<meta name="keywords" content="Aegis" />
	<meta name="title" content="Aegis" />
	<meta name="description" content="Aegis" />
	
	<!-- TODO: social url link image -->
	<meta property="og:url" content="">
	<meta property="og:title" content="Aegis">
	<meta property="og:type" content="website">
	<meta property="og:image" content="">
	<meta property="og:description" content="Aegis 홈페이지입니다.">
	
	<!-- TODO: favicon -->
	<link rel="icon" href="./assets/images/favicon.png" type="image/png" />

	<!-- TODO: import -->
	<%@ include file="/page/layout/common.jsp"%>
	    
	<script src="./js/service/malware/exceptMalware.js?v=${version}"></script>
	<script src="./js/service/malware/fileSystem.js?v=${version}"></script>
	<script src="./js/service/malware/malwareSocket.js?v=${version}"></script>
</head>
<body>

<h1>Aegis ADMIN</h1>
<div class="skip_navigation">
    <ul>
        <li>
            <a href="#Content" class="go_content">본문 바로가기</a>
        </li>
        <li>
            <a href="#Gnb">메뉴 바로가기</a>
        </li>
    </ul>
</div>

<jsp:include page="/page/layout/sidebar.jsp" flush="false">
	<jsp:param name="menuId" value="malwareExcept" />
</jsp:include>

<jsp:include page="/page/layout/topbar.jsp" flush="false">
	<jsp:param name="menuId" value="malwareExcept" />
</jsp:include>

<input id="editRuleIdx" type="hidden">
<input id="selAgentID" type="hidden">

<section class="computer_page mscrollbar">

    <script type="text/javascript">
        $(function () {
            $(".computer_box_left").resizable({
                minWidth: 360,
                maxWidth: 600,
                handles: "e",
                resize: function (e, ui) {
                    var currentWidth = ui.size.width;
                    var gap = 10;
                    currentWidth += gap;
                    $(".computer_box_right").css("width", "calc(100% - " + currentWidth + "px)");
                }
            });
            $('.tree').mCustomScrollbar({
                autoExpandScrollbar: "true",
                axis:"yx",
                scrollInertia: 600,
            });
        });
    </script>

    <script type="text/javascript">        
        $(function () {
            $('#Tree01 .tree_wrap').jstree({
                "core" : {
                    "animation" : 0,
                    "check_callback" : true,
                    'force_text' : true,
                    "themes" : { "stripes" : false },
                    check_callback: (operation, node, node_parent, node_position, more) => {
                    	if (operation === "move_node" && more.ref === undefined) {
                    		var pData = dataMap[node_parent.id];
                    		var cData = dataMap[node.id];
                    		if(!pData) return false; // 부모가 없어서(욕아님)
                    		if(!cData) return false; // 자식데이터가 없어서

                    		return moveNode(pData, cData);                    		
                    	}
                    }
                },
                "types" : {
                    "cloudid" :{
                    },
                    "file" : {
                        'icon': 'jstree-file'
                    },
                    "file_offline" : {
    					'icon': 'jstree-file_offline'
    				},
                    'folder' : {
                        'icon': ''
                    }
                },
                "dnd" : {
                    "drop_finish" : function () {
                        alert("DROP");
                    },
                    "drag_check" : function (data) {
                        alert("CHECK");
                        if(data.r.attr("id") == "phtml_1") {
                            return false;
                        }
                        return {
                            after : true,
                            before : true,
                            inside : true
                        };
                    },
                    "drag_finish" : function (data) {
                        alert("DRAG OK");
                    }
                },
                'contextmenu' : {
                    "items" : {
                    },
                    "show_at_node" : false
                },
                "plugins" : [ "contextmenu", "state", "types", "dnd", "wholerow"],
            }).bind("dblclick.jstree", function (event) {
            	//console.log('dblclick.jstree');
            }).bind("click.jstree", function (event) {
            	//console.log('click.jstree');
            }).bind("select_node.jstree", function (event, data) {
            	clickNode(data);
            });
            $('.tree_wrap').on("change.jstree", function (e, data) {
                $(".tree").mCustomScrollbar('update');
            });

        });

        $(function () {
            $('#Tree02 .tree_wrap').jstree({
                "core" : {
                    "animation" : 0,
                    "check_callback" : true,
                    'force_text' : true,
                    "themes" : { "stripes" : false },
                },
                "types" : {
                    "file" : {
                        'icon': 'jstree-file'
                    },
                    "file_offline" : {
    					'icon': 'jstree-file_offline'
    				},
                    'folder' : {
                        'icon': ''
                    }
                },
                "plugins" : [ "state", "types", "wholerow"],
            }).bind("select_node.jstree", function (event, data) {
                //Double Click to Rename
            	selTreeNode(data);
            });
        });
    </script>
	
	<div class="sub">
		<div class="computer_box manager">
			<div class="computer_box_left">
				<div id="Tree01" class="content tree">
					<div class="tree_wrap">
						<ul>
							<li id="G0000000000000" data-jstree='{ "cloudid"="G0000000000000", "opened" : true, "state" : "open" }'>Aegis</li>
						</ul>
					</div>
				</div>
			</div>
			<div class="computer_box_right">
				<div style="width: 30%; float: left; padding-right: 20px">
					<table>
						<colgroup>
							<col width="30%">
							<col width="5%">
							<col width="65%">
						</colgroup>
						<tr style="height: 50px;">
							<td style="color: #bbb; font-size: 13px; font-weight: 400; margin-bottom: 5px;">선택 자산</td>
							<td></td>
							<td style="color: #bbb; font-size: 13px; font-weight: 400; margin-bottom: 5px;" id="assetInfo">없음</td>
						</tr>
						<tr style="height: 50px;">
							<td style="color: #bbb; font-size: 13px; font-weight: 400; margin-bottom: 5px;">파일시스템</td>
							<td></td>
							<td style="color: #bbb; font-size: 13px; font-weight: 400; margin-bottom: 5px;" id="fileInfo"></td>
						</tr>
					</table>
					<div class="edit" style="height: 665px;">
						<div class="info on">
							<div id="Tree02" class="content tree" style="height: 631px;">
								<div class="tree_wrap">
									<ul>
										<li data-jstree='{ "cloudid"="_filesystem", "opened" : true, "state" : "open" }'>File</li>
									</ul>
								</div>
							</div>
						</div>
					</div>
				</div>
				<div style="width: calc(70% - 20px); float: left;">
					<div class="tit_wrap" style="height: 100%;">
						<table>
							<colgroup>
								<col width="15%">
								<col width="53%">
								<col width="2%">
								<col width="30%">
							</colgroup>
							<tr style="height: 50px;">
								<td style="color: #bbb; font-size: 13px; font-weight: 400; margin-bottom: 5px;">모드</td>
								<td colspan="3">
									<div class="sel_box" style="width: 100px;">
										<select class="popup_sel" id="mode">
											<option value="SKIP" selected="selected">SKIP</option>
										</select>
									</div>
								</td>
							</tr>
							<tr style="height: 50px;">
								<td style="color: #bbb; font-size: 13px; font-weight: 400; margin-bottom: 5px;">파일</td>
								<td>
									<div class="ipt_box" style="width: 500px;">
										<input type="text" id="filename" placeholder="파일의 전체 경로를 작성해주세요." name="required">
									</div>
								</td>
								<td></td>
								<td>
									<a href="#" class="btn policy_add malware_add_btn">경로 추가</a>
									<a href="#" class="btn policy_edit malware_add_btn" style="display: none;">경로 수정</a>
									<a href="#" class="btn policy_edit rule_edit_cancel_btn" style="display: none;">취소</a>
								</td>
							</tr>
						</table>
					</div>
					<div class="tbl">
						<table id="malwareTable" class="scroll hover" style="width: 100%">
							<colgroup>
								<col width="15%">
								<col width="auto">
								<col width="15%">
								<col width="15%">
							</colgroup>
							<thead>
								<tr>
									<th>모드</th>
									<th>파일</th>
									<th>수정 / 삭제</th>
									<th>정렬</th>
								</tr>
							</thead>
							<tbody>
							</tbody>
						</table>
					</div>
					<div class="btn_wrap">
						<div class="fr">
							<a href="#" class="btn disabled" id="applyBtn">설정 적용</a>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
</section>

<div class="modal scan_progress" id="progress_modal_malware" rel="">
	<div class="modal_header">
        <h3></h3>
    </div>
    <div class="modal_body">
        <div class="modal_cont">
            <dl>
        		<dt>
					<span>진행 상태</span>
				</dt>
				<dd>
					<div class="ipt_box">
						<input class="no_radius" type="text" id="malwareProgressStatus" value="처리량에 따라 수 초 또는 수 분이 걸릴 수 있습니다." readonly="">
					</div>
				</dd>
			</dl>
        	<dl>
        		<dt>
					<span>검사 시간</span>
				</dt>
				<dd>
					<div class="ipt_box">
						<input class="no_radius" type="text" id="malwareProgressTime" value="-" readonly="">
					</div>
				</dd>
			</dl>
			<dl>
				<dt>
					<span>검사 개수</span>
				</dt>
				<dd>
					<div class="ipt_box">
						<input class="no_radius" type="text" id="scanFileCnt" value="-" readonly="">
					</div>
				</dd>
			</dl>
			<dl>
				<dt>
					<span>감염 개수</span>
				</dt>
				<dd>
					<div class="ipt_box">
						<input class="no_radius" type="text" id="malwareFileCnt" value="-" readonly="">
					</div>
				</dd>
			</dl>
			<dl>
				<dt>
					<span>검사 파일</span>
				</dt>
				<dd>
					<div class="ipt_box">
						<input class="no_radius" type="text" id="scanFilePath" value="-" readonly="">
					</div>
				</dd>
			</dl>
		</div>
    </div>
    <div class="modal_footer">
        <div class="btn_wrap fr">        	
        	<a href="#" class="btn grey close">닫기</a>
            <a href="#" class="btn" id="stopBtn" >검사 중지</a>
        </div>
    </div>
    <div class="modal_controller">
        <a href="#" class="close">close</a>
    </div>
</div>
</body>
</html>
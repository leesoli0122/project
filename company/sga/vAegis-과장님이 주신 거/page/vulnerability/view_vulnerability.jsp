<%@page language="java" contentType="text/html; charset=utf-8" pageEncoding="UTF-8"%>
<!DOCTYPE html>
<html lang="ko">

<head>
    <title>취약점 조회 - Aegis</title>
    <meta charset="UTF-8" http-equiv="Content-Type">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=3.0">
	<meta name="mobile-web-app-capable" content="yes">
	<meta name="format-detection" content="telephone=no" />
	
	<!-- TODO: search engine info -->
	<meta name="robots" content="Aegis" />
	<meta name="keywords" content="Aegis" />
	<meta name="title" content="Aegis" />
	<meta name="description" content="Aegis" />
	
	<!-- TODO: social url link image -->
	<meta property="og:url" content="">
	<meta property="og:title" content="Aegis">
	<meta property="og:type" content="website">
	<meta property="og:image" content="">
	<meta property="og:description" content="Aegis 홈페이지입니다.">
	
	<!-- TODO: favicon -->
	<link rel="icon" href="./assets/images/favicon.png" type="image/png" />

	<!-- TODO: import -->
	<%@ include file="/page/layout/common_sample.jsp"%>

    <script src="./js/service/vulnerability/vulnerabilityView.js?v=${version}"></script>
    
    <style>
		.ovalPass {
			color : #22aec7;
		}
		.ovalFail {
			color : #dd5138;
		}
		.ref_url {
			color : #bbb;
		}
		
		table td {
		white-space: nowrap;
		text-overflow: ellipsis;
		word-break: break-all;
		overflow: hidden;
		}
	</style>
</head>

<script type="text/javascript">
	$.urlParam = function(name){    
		var results = new RegExp('[\?&amp;]' + name + '=([^&amp;#]*)').exec(window.location.href);
		if(results) {
			if(results.length > 1) return results[1] || 0;
		}
	    return null;
	}
	
	$(function () {
		$(".computer_box_left").resizable({
			minWidth: 360,
			maxWidth: 600,
			handles: "e",
			resize: function (e, ui) {
				var currentWidth = ui.size.width;
				var gap = 10;
				currentWidth += gap;
				$(".computer_box_right").css("width", "calc(100% - " + currentWidth + "px)");
			}
		});
		$('.tree').mCustomScrollbar({
			autoExpandScrollbar: "true",
			axis:"yx",
			scrollInertia: 600,
		});
		$('#Tree01 .tree_wrap').jstree({
			"core" : {
				"animation" : 0,
				"check_callback" : true,
				'force_text' : true,
				"themes" : { "stripes" : false },
				check_callback: (operation, node, node_parent, node_position, more) => {
					if (operation === "move_node" && more.ref === undefined) {
						var pData = dataMap[node_parent.id];
						var cData = dataMap[node.id];
						if(!pData) return false; // 부모가 없어서(욕아님)
						if(!cData) return false; // 자식데이터가 없어서
						return moveNode(pData, cData);                    		
					}
				}
			},
			"types" : {
				"cloudid" :{
				},
				"file" : {
					'icon': 'jstree-file'
				},
				"file_offline" : {
					'icon': 'jstree-file_offline'
				},
				'folder' : {
					'icon': ''
				}
			},
			"plugins" : [ "state", "types", "wholerow"],
		}).bind("select_node.jstree", function (event, data) {
			clickNode(data);
		});
		$('.tree_wrap').on("change.jstree", function (e, data) {
			$(".tree").mCustomScrollbar('update');
		});

		_QUERY_EQUIP_ID = $.urlParam('equip_id');
	});
	
	$(document).ready(function() {
		/* Formatting function for row details - modify as you need */
		$('#vulnerabilityTable').DataTable({
			"autoWidth": false,
			"paging": true,
			"pagingType": "full_numbers",
			"ordering": true,
			"order" : [[0, "desc"]],
			"info": true,
			"filter": true,
			"lengthChange": true,
			"language": {
				"lengthMenu":
					'<span>show</span>'+
					'<div class="sel_box">'+
					'<select class="table_top">'+
					'<option value="-1">All</option>'+
					'<option value="10">10</option>'+
					'<option value="25">25</option>'+
					'<option value="50">50</option>'+
					'<option value="100">100</option>'+
					'</select>'+
					'</div>'+
					'<span>entries</span>'
					,
				"info": "<span>_PAGE_</span> - _PAGES_ / _MAX_",
			},
			"dom": '<"top"lf>rt<"bottom"ip><"clear">',
			//"pageLength": 10,
		});
		$('.sel_box select').niceSelect();
	});
</script>

<body>
	<h1>Aegis ADMIN</h1>
	<div class="skip_navigation">
		<ul>
			<li><a href="#Content" class="go_content">본문 바로가기</a></li>
			<li><a href="#Gnb">메뉴 바로가기</a></li>
		</ul>
	</div>

	<jsp:include page="/page/layout/sidebar_sample.jsp" flush="false">
		<jsp:param name="menuId" value="vulnerabilityScan" />
	</jsp:include>

	<jsp:include page="/page/layout/topbar_sample.jsp" flush="false">
		<jsp:param name="menuId" value="vulnerabilityScan" />
	</jsp:include>
	
	<input type="hidden" name="checkedProcessList" value=""/>
	<section class="scroll_no"><!--ㅜ 2024-01-23 : nmscrollbar 제거 및 scroll_no 클래스 추가-->
		<div class="sub">
			<div class="content_wrap">
				<div class="computer_box manager">
					<div class="computer_box_left">
						<div id="Tree01" class="content tree">
							<div class="tree_wrap">
								<ul>
									<li id="G0000000000000" data-jstree='{ "cloudid"="G0000000000000", "opened" : true, "state" : "open" }'>Aegis</li>
								</ul>
							</div>
						</div>
					</div>
					<div class="computer_box_right scroll_yes"><!-- 2024-01-23 : scroll_yesn 클래스 추가-->
						<div class="tit_wrap">
							<div class="fl">
								<h5>
									<span id="equip"></span>
									<span id="cve"></span>
									<span id="revisetime"></span>
								</h5>
								<h5>
									<a href="#" class="btn" onclick="javascript: scan(1); return false;" id="scanBtn">스캔</a> 
									<span id="reportfilename"></span>               					
								</h5>	        	
							</div>
						</div>
						<div class="tbl vulnerability_table_wrapper">
							<table id="vulnerabilityTable" class="click">
								<colgroup>
									<col width="15%">
									<col width="10%">
									<col width="35%">
									<col width="40%">
								</colgroup>
								<thead>
									<tr>
										<th>결과</th>
										<th>분류</th>
										<th>레퍼런스</th>
										<th>내용</th>
									</tr>
								</thead>
								<tbody>
								</tbody>
							</table>
						</div>
					</div>
				</div>
			</div>
		</div>
	</section>
</body>